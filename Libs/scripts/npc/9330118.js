var status = -1;

function start() {
    status = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == 1) {
	status++;
    } else {
	cm.dispose();
		return ;
    }
    if (status == 0) {
	if (cm.getMeso() >= 300000) {
	    cm.sendYesNo("您身上有#i4031138# 300,000 楓幣 可以進行轉蛋。\r\n你確定要使用 #b卷軸轉蛋機#k 進行轉蛋嗎?");
	} else {
	    cm.sendOk("不好意思!您沒有#i4031138# 300,000 楓幣。");
	    cm.safeDispose();
	}
    } else if (status == 1) {
	var item1, item2, item3;
    // var itemList = new Array(2040317, 2022113, 2043201, 2044001, 2041038, 2041039,
    //     2041036, 2041037, 2041040, 2041041, 2041026, 2041027, 2044600, 2043301,
    //     2040308, 2040309, 2040304, 2040305, 2040810, 2040811, 2040812, 2040813, 2040814,
    //     2040815, 2040008, 2040009, 2040010, 2040011, 2040012, 2040013, 2040510, 2040511,
    //     2040508, 2040509, 2040518, 2040519, 2040520, 2040521, 2044401, 2040900, 2040902,
    //     2040908, 2040909, 2044301, 2040406, 2040407, 2022113, 2040834);
    var itemList = new Array(2040001, 2040002, 2040004, 2040005, 2040008, 2040009, 2040010,
          2040011, 2040012, 2040013, 2040014, 2040015, 2040016, 2040017, 2040023, 2040025,
          2040026, 2040028, 2040029, 2040030, 2040031, 2040100, 2040101, 2040103, 2040104,
          2040105, 2040106, 2040108, 2040109, 2040200, 2040201, 2040203, 2040204, 2040205,
          2040206, 2040208, 2040209, 2040301, 2040302, 2040304, 2040305, 2040306, 2040307,
          2040308, 2040309, 2040310, 2040311, 2040317, 2040318, 2040320, 2040321, 2040322,
          2040323, 2040325, 2040326, 2040327, 2040328, 2040329, 2040330, 2040331, 2040401,
          2040402, 2040404, 2040405, 2040406, 2040407, 2040408, 2040409, 2040410, 2040411,
          2040412, 2040413, 2040418, 2040419, 2040421, 2040422, 2040424, 2040425, 2040426,
          2040427, 2040501, 2040502, 2040504, 2040505, 2040508, 2040509, 2040510, 2040511,
          2040513, 2040514, 2040516, 2040517, 2040518, 2040519, 2040520, 2040521, 2040531,
          2040532, 2040533, 2040534, 2040601, 2040602, 2040604, 2040605, 2040606, 2040607,
          2040608, 2040609, 2040610, 2040611, 2040612, 2040613, 2040618, 2040619, 2040621,
          2040622, 2040624, 2040625, 2040626, 2040627, 2040701, 2040702, 2040704, 2040705,
          2040707, 2040708, 2040712, 2040713, 2040714, 2040715, 2040716, 2040717, 2040727,
          2040801, 2040802, 2040804, 2040805, 2040808, 2040809, 2040810, 2040811, 2040812,
          2040813, 2040814, 2040815, 2040816, 2040817, 2040824, 2040825, 2040826, 2040901,
          2040902, 2040904, 2040905, 2040906, 2040907, 2040908, 2040909, 2040910, 2040914,
          2040915, 2040916, 2040917, 2040919, 2040920, 2040921, 2040922, 2040924, 2040925,
          2040927, 2040928, 2040930, 2040931, 2040932, 2040933, 2041001, 2041002, 2041004,
          2041005, 2041007, 2041008, 2041010, 2041011, 2041013, 2041014, 2041016, 2041017,
          2041019, 2041020, 2041022, 2041023, 2041026, 2041027, 2041028, 2041029, 2041030,
          2041031, 2041032, 2041033, 2041034, 2041035, 2041036, 2041037, 2041038, 2041039,
          2041040, 2041041, 2041042, 2041058, 2041101, 2041102, 2041104, 2041105, 2041107,
          2041108, 2041110, 2041111, 2041112, 2041113, 2041114, 2041115, 2041116, 2041117,
          2041118, 2041119, 2041200, 2041201, 2041202, 2041204, 2041205, 2041206, 2041207,
          2041209, 2041210, 2041301, 2041302, 2041304, 2041305, 2041307, 2041308, 2041310,
          2041311, 2041312, 2041313, 2041314, 2041315, 2041316, 2041317, 2041318, 2041319,
          2387021, 2043001, 2043002, 2043004, 2043005, 2043006, 2043007, 2043008, 2043009,
           2043016, 2043017, 2043018, 2043019, 2043101, 2043102, 2043104, 2043105, 2043111,
           2043112, 2043113, 2043114, 2043201, 2043202, 2043204, 2043205, 2043211, 2043212,
           2043213, 2043214, 2043301, 2043302, 2043304, 2043305, 2043701, 2043702, 2043704,
            2043705, 2043801, 2043802, 2043804, 2043805, 2044001, 2044002, 2044004, 2044005,
            2044011, 2044012, 2044013, 2044014, 2044015, 2044101, 2044102, 2044104, 2044105,
            2044111, 2044112, 2044113, 2044114, 2044201, 2044202, 2044204, 2044205, 2044211,
            2044212, 2044213, 2044214, 2044301, 2044302, 2044304, 2044305, 2044311, 2044312,
            2044313, 2044314, 2044401, 2044402, 2044404, 2044405, 2044411, 2044412, 2044413,
            2044414, 2044501, 2044502, 2044504, 2044505, 2044506, 2044601, 2044602, 2044604,
            2044605, 2044606, 2044701, 2044702, 2044704, 2044705, 2044706, 2044801, 2044802,
            2044803, 2044804, 2044806, 2044807, 2044808, 2044809, 2044901, 2044902, 2044903,
            2044904, 2048001, 2048002, 2048004, 2048005, 2048006, 2048007, 2048008, 2048009,
            2048010, 2048011, 2048012, 2048013, 2048014, 2048015, 2048016, 2048017, 2049000,
            2049001, 2049002, 2049100);
	    item1 = cm.gainGachaponItem(itemList[Math.floor(Math.random() * itemList.length)], 1);

	if (item1 != -1) {
	    cm.gainMeso(-300000);
	    cm.sendOk("您已獲得 #b#t" + item1 + "##i" + item1 + "##k");
	} else {
	    cm.sendOk("檢查一下背包是否已滿。");
	}
	cm.safeDispose();
    }
}
